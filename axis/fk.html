<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="CashCount helps you calculate the cashback received on your transactions, making it easier to track your savings.">
    <meta name="keywords" content="CashCount, cashback calculator, credit card rewards, cashback tracking, finance, savings, how to get credit card cashback, calculate credit card cashback">
    <link rel="icon" href="../logo.png" type="image/png">
    <meta name="google-site-verification" content="p2wrjXgGd8_chTaVBvwOWh_6By7oPaoRuWA8NvFboNE" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <title>CashCount | Axis Flipkart</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  margin: 0;
  color: #ddd;
  padding-top: 150px;
  background-color: black;
}

.background {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background: url('https://wallpapercave.com/wp/wp4782115.jpg') center center/cover no-repeat fixed;
  z-index: -1;
}


.glass {
  backdrop-filter: blur(10px) saturate(180%);
  border-radius: 12px;
}

.glass-grey {
  background-color: rgba(17, 25, 40, 0.75);
  border: 1px solid rgba(255, 255, 255, 0.125);
}

.glass-blue {
  background-color: rgba(26, 206, 221, 0.25);
  border: 1px solid rgba(26, 206, 221, 0.25);
}

.glass-green {
  background: rgba(109, 8, 170, 0.5);
  border: 1px solid rgba(109, 8, 170, 0.25);
}

input {
  backdrop-filter: blur(10px) saturate(180%);
  border-radius: 12px;
  background-color: rgba(109, 197, 160, 0.25);
}

input:hover {
  border: 1px solid rgba(109, 197, 160, 0.25);
}

h1,
h2 {
  text-align: center;
}

.input-section {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
}

.input-section label {
  font-weight: bold;
  margin-right: 10px;
}

.input-section input[type="number"],
.input-section input[type="date"] {
  padding: 5px;
  margin-right: 10px;
  border-radius: 4px;
  border-width: 1px;
}

button {
  padding: 10px 20px;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.center {
  display: flex;
  justify-content: center;
  align-items: center;
}

#add-btn {
  padding: 10px 20px;
}

.expenses-list {
  margin: 20px;
}

table {
  width: 100%;
  border-spacing: 0;
  border-collapse: separate;
  border-radius: 10px;
}

table tr:first-child th:first-child {
  border-top-left-radius: 10px;
}

table tr:first-child th:last-child {
  border-top-right-radius: 10px;
}

th,
td {
  padding: 8px;
  text-align: left;
}

th {
  color: white;
}

tfoot td {
  font-weight: bold;
}

input {
  color: white;
}

.hidden {
  display: none;
}

.dropdown {
  border: 1px solid #ccc;
  color: white;
  padding: 5px;
  border-radius: 4px;
  border-width: 1px;
}

option {
  color: black;
}

/* Modal styles */
.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
  margin: 15% auto;
  padding: 20px;
  width: 50%;
  border-radius: 10px;
}

.form-field {
  margin-bottom: 10px;
}

/* Input field styles */
input[type="date"],
input[type="number"] {
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: 14px;
  width: 200px;
}

/* Input field hover style */
input[type="date"]:hover,
input[type="number"]:hover {
  border-color: #999;
}

/* Input field focus style */
input[type="date"]:focus,
input[type="number"]:focus {
  border-color: #555;
  outline: none;
}

/* Placeholder text color */
input::placeholder {
  color: #999;
}

/* Styling for submit button */
button[type="submit"] {
  padding: 8px 16px;
  background-color: #2196f3;
}

button[type="submit"]:hover {
  background-color: #2196f3;
}

/* Styling for success button */
.success-btn {
  margin: 0 10px;
  background-color: #2196f3;
}

.success-btn:hover {
  background-color: #2196f3;
}

/* Styling for update button */
.update-btn {
  margin: 0 10px;
  background-color: #2196f3;
}

.update-btn:hover {
  background-color: #2196f3;
}

/* Styling for cancel button */
.danger-btn {
  margin: 0 10px;
  background-color: #f44336;
}

.danger-btn:hover {
  background-color: #da190b;
}

/*Styling Button Bar */
.button-bar {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

/* Styling for Footer */
footer {
  position: fixed;
  bottom: 0;
  width: -webkit-fill-available;
  margin: 10px;
  background: rgba(17, 25, 40, 0.75);
  backdrop-filter: blur(16px);
  border: 1px solid rgba(17, 25, 40, 0.375);
  border-radius: 10px;
  color: #ddd;
  margin-bottom: 15px;
}

@media screen {
    footer {
  position: fixed;
  bottom: 0;
  width: -webkit-fill-available;
  margin: 10px;
  background: rgba(17, 25, 40, 0.75);
  backdrop-filter: blur(16px);
  border: 1px solid rgba(17, 25, 40, 0.375);
  border-radius: 10px;
  color: #ddd;
  margin-bottom: 15px;
}

}

.navbar {
    position: fixed;
    top: 20px; /* gap from the top */
    left: 50%;
    transform: translateX(-50%);
    width: 95%; /* gap from left/right edges */
    padding: 15px 20px;
    background: rgba(17, 25, 40, 0.75);
    backdrop-filter: blur(16px);
    border-radius: 15px; /* rounded edges */
    z-index: 1000;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
        .logo {
            display: flex;
            align-items: center;
            margin-left: 10px;
        }

        .logo img {
            height: 70px;
        }

        .logo a {
            display: flex;
            align-items: center;
            color: white;
            font-size: 35px;
            font-weight: 600;
        }

        .navbar-title {
            font-size: 22px;
            font-weight: bold;
            text-align: center;
            flex-grow: 1;
            color: rgb(255, 255, 255);
            font: bold 20px/1 sans-serif;
        }

        .nav-links {
            list-style: none;
            display: flex;
        }

        .nav-links li {
            margin: 0 15px;
        }

        .nav-links a {
            text-decoration: none;
            color: #ddd;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #fff;
        }

        .menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .menu-toggle span {
            background: #ddd;
            width: 25px;
            height: 3px;
            margin: 4px 0;
        }

@media (max-width: 768px) {
  .nav-links {
    flex-direction: column;
    position: absolute;
    top: 60px; /* Adjust based on navbar height */
    left: 0;
    width: 100%;
    background: rgba(17, 25, 40, 0.9);
    overflow: hidden;
    max-height: 0; /* Hide initially */
    opacity: 0;
    visibility: hidden;
    transition: max-height 0.5s ease-out, opacity 0.3s ease-out, visibility 0.3s ease-out;
  }

  .nav-links li {
    padding: 10px 0;
    text-align: center;
  }

  .nav-links.active {
    max-height: 300px; /* Adjust as needed */
    opacity: 1;
    visibility: visible;
  }

  .menu-toggle {
    display: flex;
    cursor: pointer;
  }
}



</style>
<body>
    <nav class="navbar">
        <div class="logo"><a href="../"><img src="../logo.png"></a></div>
        <div class="navbar-title">Axis Flipkart Credit Card</div>
        <ul class="nav-links">
            <li><a href="../about.html">About</a></li>
            <li><a href="https://mail.google.com/mail/u/0/?fs=1&to=chinta.midhilesh@gmail.com&tf=cm" target="_blank">Contact</a></li>
        </ul>
        <div class="menu-toggle" onclick="toggleMenu()">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>
    <div class="expenses-list">
        <table class="glass glass-grey">
            <thead>
                <tr class="table-headers glass glass-blue">
                    <th>Category</th>
                    <th>Dumped</th>
                    <th>Date</th>
                    <th>Cashback</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="expense-table-body">

            </tbody>
            <tfoot>
                <tr>
                    <td>You Dumped/Your Cashback on Dump:</td>
                    <td id="total-amount">₹0</td>
                    <td></td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
    </div>
    <div class="center">
        <button id="add-btn" class="success-btn">Add</button>
        <button id="download-btn" class="success-btn">Download</button>
    </div>
    <br>
    <br>
    <div class="center"><p>Cash Back will be credited to your next statement. </p></div>
    <div class="center">
        <p>For any issues, or mistakes you can mail me and it will be fixed.</p></div>
    <div>
        <br>
        <br>
    </div>
    <div class="center">
        <a href="https://www.buymeacoffee.com/Midhilesh" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a>
    </div>
    <div class="background"></div>

    <div id="myModal" class="modal">
        <div class="modal-content glass glass-green">
            <h2 id="form-title">Update Entry</h2>
            <form id="updateForm">
                <div class="form-field">
                    <label for="form-category-select">Category:</label>
                    <select id="form-category-select" class="dropdown glass glass-green"></select>
                </div>
                <div class="form-field">
                    <label for="form-amount-input">You Dumped:</label>
                    <input type="number" step="0.01" id="form-amount-input">
                </div>
                <div class="form-field">
                    <label for="form-date-input">Date:</label>
                    <input type="date" id="form-date-input">
                </div>
                <div class="button-bar">
                    <button type="submit" id="update-btn" class="update-btn"></button>
                    <button type="button" id="cancel-btn" class="danger-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</body>

<footer class="center" id="footer">
    <p>For any issues, feedback, reach me out at <a href="https://mail.google.com/mail/u/0/?fs=1&to=chinta.midhilesh@gmail.com&tf=cm" target="_blank">Midhilesh Chinta</a>.</p>
</footer>

<script>
    const categorySelect = document.getElementById('form-category-select');
    const amountInput = document.getElementById('form-amount-input');
    const dateInput = document.getElementById('form-date-input');
    const addBtn = document.getElementById('add-btn');
    const expensesTableBody = document.getElementById('expense-table-body');
    const totalAmountCell = document.getElementById('total-amount');
    const modal = document.getElementById('myModal');
    const updateForm = document.getElementById('updateForm');
    const cancelBtn = document.getElementById('cancel-btn');
    const updateBtn = document.getElementById('update-btn');
    const formTitle = document.getElementById('form-title');

    const expenseCategories = [
        'Select Category',
        'Axis Partner Merchants',
        'ClearTrip',
        'Flipkart',
        'International Transactions',
        'Offline Spends',
        'Other Spends (0% Cashback)',
    ];

    const cashbackRates = {
        'Axis Partner Merchants': 0.04,
        'ClearTrip': 0.05,
        'Flipkart': 0.05,
        'International Transactions' : 0.00,
        'Offline Spends': 0.01,
        'Other Spends (0% Cashback)': 0.00,
    };

    const totalRow = document.querySelector("tfoot tr");

    const totalCashbackCell = document.createElement('td');
    totalCashbackCell.id = "total-cashback";
    totalCashbackCell.textContent = "₹0.00";
    totalRow.appendChild(totalCashbackCell);
    window.addEventListener('load', load);

    addBtn.addEventListener('click', openModal);

    function setCategories() {
        categorySelect.innerHTML = '';
        const categories = expenseCategories;
        for (const category of categories) {
            const option = document.createElement('option');
            option.value = category;
            option.textContent = category;
            categorySelect.appendChild(option);
        }
    }

    function load() {
        const expenses = JSON.parse(localStorage.getItem("FK") || "[]");

        for (const expense of expenses) {
            addExpense(expense);
        }

        updateSummary();
    }

    function addExpense(expense = {}) {
        const newRow = expensesTableBody.insertRow();

        const categoryCell = newRow.insertCell();
        const amountCell = newRow.insertCell();
        const dateCell = newRow.insertCell();
        const cashbackCell = newRow.insertCell(); // Cashback column comes here
        const updateCell = newRow.insertCell();
        const editBtn = document.createElement('button');
        const deleteBtn = document.createElement('button');

        deleteBtn.textContent = 'Delete';
        deleteBtn.classList.add('btn', 'danger-btn');
        editBtn.textContent = 'Edit';
        editBtn.classList.add('btn', 'update-btn');
        editBtn.addEventListener('click', handleEditButtonClick);

        deleteBtn.addEventListener('click', event => {
            event.target.closest('tr').remove();
            save();
        });

        categoryCell.textContent = expense.category;
        amountCell.textContent = formatCurrency(expense.amount);
        dateCell.textContent = expense.date;

        const cashbackRate = cashbackRates[expense.category] || 0;
        const cashbackAmount = expense.amount * cashbackRate;
        cashbackCell.textContent = formatCurrency(cashbackAmount);

        updateCell.appendChild(editBtn);
        updateCell.appendChild(deleteBtn);

        save();
    }


    let currentRow = null;

    function handleEditButtonClick(event) {
        const row = event.target.closest('tr');
        categorySelect.value = row.querySelector('td:nth-child(1)').textContent;
        amountInput.value = revertCurrency(row.querySelector('td:nth-child(2)').textContent);
        dateInput.value = row.querySelector('td:nth-child(3)').textContent;

        currentRow = row;
        openModal();
    }

    function openModal() {
        modal.style.display = 'block';
        formTitle.textContent = currentRow === null ? 'Add Expense' : 'Update Expense';
        updateBtn.textContent = currentRow === null ? 'Add' : 'Update'; // Fix: Ensure button text appears
        if (currentRow === null) {
            dateInput.max = new Date().toISOString().split("T")[0];
            dateInput.value = new Date().toISOString().split("T")[0];
        }
        setCategories();
    }

    function closeModal() {
        modal.style.display = 'none';
        updateForm.reset();
        currentRow = null;
    }

    function handleSubmit(event) {
        event.preventDefault();

        const category = categorySelect.value;
        let amount = Number(amountInput.value);
        const date = dateInput.value;

        if (isNaN(amount) || amount <= 0) {
            alert('Please enter a valid amount');
            return;
        }
        if (date === '') {
            alert('Please select a date');
            return;
        }
        if (category === '' || category === 'Select Category') {
            alert('Please select a category');
            return;
        }

        const cashbackRate = cashbackRates[category] || 0;
        const cashbackAmount = amount * cashbackRate;

        if (currentRow === null) {
            addExpense({ category, amount, date });
        } else {
            currentRow.querySelector('td:nth-child(1)').textContent = category;
            currentRow.querySelector('td:nth-child(2)').textContent = formatCurrency(amount);
            currentRow.querySelector('td:nth-child(3)').textContent = date;
            currentRow.querySelector('td:nth-child(4)').textContent = formatCurrency(cashbackAmount);
        }

        save();
        closeModal();
    }

    cancelBtn.addEventListener('click', closeModal);
    updateForm.addEventListener('submit', handleSubmit);

    window.addEventListener('click', function (event) {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });

    function save() {
        const data = getEntryRows().map(row => {
            return {
                category: row.querySelector('td:nth-child(1)').textContent,
                amount: revertCurrency(row.querySelector('td:nth-child(2)').textContent),
                date: row.querySelector('td:nth-child(3)').textContent,
                cashback: revertCurrency(row.querySelector('td:nth-child(4)').textContent),  // Ensure cashback is saved too
            };
        });

        localStorage.setItem("FK", JSON.stringify(data));
        updateSummary();
    }

    // Returns an array of all the rows in the expenses table
    function getEntryRows() {
        return Array.from(expensesTableBody.children);
    }

    function formatCurrency(amount) {
        return Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(amount);
    }

    function revertCurrency(amount) {
        return Number(amount.replace(/[^0-9.-]+/g, ""));
    }

    function updateSummary() {
        let totalSpending = 0;
        let totalCashback = 0;

        getEntryRows().forEach(row => {
            const amount = revertCurrency(row.querySelector('td:nth-child(2)').textContent);
            const cashback = revertCurrency(row.querySelector('td:nth-child(4)').textContent);
            totalSpending += amount;
            totalCashback += cashback;
        });

        totalAmountCell.textContent = formatCurrency(totalSpending);
        totalCashbackCell.textContent = formatCurrency(totalCashback); // Display total cashback inside the footer
    }

    document.getElementById('download-btn').addEventListener('click', function () {
        const data = JSON.parse(localStorage.getItem("FK") || "[]");

        if (data.length === 0) {
            alert("No data available to download.");
            return;
        }

        const worksheet = XLSX.utils.json_to_sheet(data);
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "Expenses");

        XLSX.writeFile(workbook, "AmazonPayCC.xlsx");
    });

function toggleMenu() {
  document.querySelector('.nav-links').classList.toggle('active');
}
    </script>

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="Midhilesh" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Left" data-x_margin="18" data-y_margin="18"></script>
</html>
